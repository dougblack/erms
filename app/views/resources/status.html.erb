<h1>Resources in Use</h1>
<table>
<tr>
	<th>Resource Name</th>
	<th>Incident</th>
	<th>Owner</th>
	<th>Action</th>
</tr>
<% @user_resource_requests.each do |rq| %>
	<tr>
		<td><%= Resource.find_by_sql("SELECT * FROM resources WHERE id = #{rq.resource_id}").first.name %></td>
		<td><%= Incident.find_by_sql("SELECT * FROM incidents WHERE id = #{rq.incident_id}").first.description %></td>
		<td><%= Incident.find_by_sql("SELECT * FROM incidents WHERE id = #{rq.incident_id}").first.user_id %></td>
		<td><%= link_to "Return", return_path(:rq_id => rq.id) %>
	</tr>
<% end %>
</table>

<h1>Requests sent by me</h1>
<table>
<tr>
	<th>Resource Name</th>
	<th>Incident</th>
	<th>Owner</th>
	<th>Action</th>
</tr>
<% @requests_sent.each do |rq| %>
	<tr>
		<td><%= Resource.find_by_sql("SELECT * FROM resources WHERE id = #{rq.resource_id}").first.name %></td>
		<td><%= Incident.find_by_sql("SELECT * FROM incidents WHERE id = #{rq.incident_id}").first.description %></td>
		<td><%= Incident.find_by_sql("SELECT * FROM incidents WHERE id = #{rq.incident_id}").first.user_id %></td>
		<td><%= link_to "Cancel", rq, method: :delete %></td>
	</tr>
<% end %>
</table>

<h1>Requests sent by others</h1>
<table>
<tr>
	<th>Resource Name</th>
	<th>Incident</th>
	<th>Owner</th>
	<th colspan="2">Action</th>
</tr>
<% @requests_received.each do |rq| %>
	<tr>
		<td><%= Resource.find_by_sql("SELECT * FROM resources WHERE id = #{rq.resource_id}").first.name %></td>
		<td><%= Incident.find_by_sql("SELECT * FROM incidents WHERE id = #{rq.incident_id}").first.description %></td>
		<td><%= Incident.find_by_sql("SELECT * FROM incidents WHERE id = #{rq.incident_id}").first.user_id %></td>
		<td><%= link_to "Deploy", deploy_request_path(:id => rq.id) %></td>
		<td><%= link_to "Reject", reject_path(:rq_id => rq.id) %></td>
	</tr>
<% end %>
</table>